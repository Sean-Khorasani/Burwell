{
  "description": "Debug variable substitution using clipboard output",
  "parameters": {},
  "sequence": [
    {
      "comment": "Step 1: Find Firefox windows and store result",
      "command": "UIA_FIND_WINDOWS_BY_CLASS",
      "parameters": {
        "className": "MozillaWindowClass",
        "store_as": "firefoxWindows"
      }
    },
    {
      "comment": "Step 2: Test if basic variable substitution works by setting clipboard",
      "command": "UIA_SET_CLIPBOARD",
      "parameters": {
        "text": "Variable content: ${firefoxWindows}"
      }
    },
    {
      "comment": "Step 3: Get clipboard to see what was substituted",
      "command": "UIA_GET_CLIPBOARD",
      "parameters": {
        "store_as": "basicTest"
      }
    },
    {
      "comment": "Step 4: Test array indexing by setting clipboard",
      "command": "UIA_SET_CLIPBOARD",
      "parameters": {
        "text": "Array index test: ${firefoxWindows[0]}"
      }
    },
    {
      "comment": "Step 5: Get clipboard to see array indexing result",
      "command": "UIA_GET_CLIPBOARD",
      "parameters": {
        "store_as": "arrayTest"
      }
    },
    {
      "comment": "Step 6: Output results via system command",
      "command": "SYSTEM_COMMAND",
      "parameters": {
        "command": "echo [TEST] Basic substitution result should be in clipboard"
      }
    },
    {
      "comment": "Step 7: Output array test via system command",
      "command": "SYSTEM_COMMAND",
      "parameters": {
        "command": "echo [TEST] Array indexing result should be in clipboard"
      }
    },
    {
      "comment": "Step 8: Try the actual UIA_FOCUS_WINDOW with both parameter names",
      "command": "SYSTEM_COMMAND",
      "parameters": {
        "command": "echo [TEST] About to test UIA_FOCUS_WINDOW with window parameter"
      }
    }
  ]
}